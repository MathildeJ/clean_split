
<!DOCTYPE html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Untitled Document</title>

<link href="../static/splitscreen.css" rel="stylesheet">

</head>

<body>

<div class="box"><iframe id="ifrm1" src="" height="700" width="49%" align='left'></iframe></div>
<div class="box"><iframe id="ifrm2" src="./third_frame" height="700" width="49%" align='right'></iframe></div>

<script>
// get the current url and the follower link
pageUrl  = document.location.href;
var idIndex = pageUrl.indexOf("screen");
var sessionID = pageUrl.substring(idIndex+6);
var fullUrl =  "https://surfly-s1.com".concat(sessionID);

// set the url of the first frame to the follower link
document.getElementById('ifrm1').src = fullUrl;
</script>

<script>
var eventMethod = window.addEventListener ? "addEventListener" : "attachEvent";
var eventer = window[eventMethod];
var messageEvent = eventMethod == "attachEvent" ? "onmessage" : "message";

// Listen to message from child IFrame window
eventer(messageEvent, function (e) {
   if (typeof e.data === 'string') { 
     // we use a regex to match the follower link and extract it from the data 
     if (e.data.match(/[0-9]{3}[-][0-9]{3}[-][0-9]{3}/)) {
	var theLink = e.data;
	var frame = document.getElementById('ifrm1').contentWindow;
	// we send the link to the first frame (where a Surfly session is already started)
	frame.postMessage(JSON.stringify({"command": "message", "data": theLink}), '*');
     }
   }
 }, false);
</script>

</body>
</html>
